{
  "id": 1000273,
  "type": "Template",
  "name": "GENERIC_V2_INV_NBS_5_4",
  "description": "This Generic V2 investigation template was created with NBS 5.4 based on the CDC MMG dated 12/06/2017. Jurisdictions should inactivate any existing generic v2 templates after upgrading to NBS 5.4 and use this version going forward. This template is compatible with NBS 5.4 and up.",
  "busType": "INV",
  "status": 1,
  "blocks": [
    {
      "id": 1091073,
      "parent": null,
      "order": 1,
      "name": "Investigation: Generic",
      "type": "Page",
      "required": false,
      "groupSeq": null,
      "blockName": null,
      "version": 1
    },
    {
      "id": 1091083,
      "parent": 1091073,
      "order": 2,
      "name": "Patient",
      "type": "Tab",
      "required": false,
      "groupSeq": null,
      "blockName": null,
      "version": 1
    },
    {
      "id": 1090987,
      "parent": 1091083,
      "order": 3,
      "name": "Patient Information",
      "type": "Section",
      "required": false,
      "groupSeq": null,
      "blockName": null,
      "version": 1
    },
    {
      "id": 1090952,
      "parent": 1090987,
      "order": 13,
      "name": "Other Personal Details",
      "type": "Subsection",
      "required": false,
      "groupSeq": null,
      "blockName": null,
      "version": 1,
      "elements": [
        {
          "id": 1090964,
          "parent": 1090952,
          "order": 16,
          "label": "Reported Age",
          "name": "Patient Age Reported",
          "description": "Subject age at time of case investigation.",
          "tooltip": "The patient's age reported at the time of interview.",
          "type": "Input",
          "dataType": "Numeric",
          "identifier": "INV2001",
          "relatedElement": "INV2002",
          "parentElement": null,
          "dataLocation": "PERSON.AGE_REPORTED",
          "size": "3",
          "min": 1,
          "max": 150,
          "version": 1,
          "valueSetCode": null,
          "oid": "2.16.840.1.114222.4.5.232",
          "oidSystem": "PHIN Questions",
          "standard": true,
          "nndMsg": true,
          "entryMethod": "USER",
          "questionType": "PHIN",
          "rdbTable": "D_PATIENT",
          "rdbColumn": "PATIENT_AGE_REPORTED",
          "otherValue": false,
          "groupSeq": null,
          "groupName": "GROUP_DEM",
          "subGroupName": "IPO",
          "blockName": null,
          "batchHeader": null,
          "batchColWidth": null,
          "mappings" : {
            "nnd" : {
              "identifier": "INV2001",
              "legacyIdentifier": "DEM216",
              "standard": false,
              "hl7Segment": "OBX-3.0",
              "required": "O",
              "dataType": "SN",
              "orderGroup": "2"
            }
          }
        },
        {
          "id": 1090939,
          "parent": 1090952,
          "order": 17,
          "label": "Reported Age Units",
          "name": "Patient Age Reported Unit",
          "description": "Subject age units at time of case investigation",
          "tooltip": "Patient's age units",
          "type": "Select",
          "dataType": "Coded",
          "identifier": "INV2002",
          "relatedElement": null,
          "parentElement": "INV2001",
          "dataLocation": "PERSON.AGE_REPORTED_UNIT_CD",
          "size": null,
          "min": null,
          "max": null,
          "version": 1,
          "valueSetCode": "PHVS_AgeUnit_UCUM",
          "oid": "2.16.840.1.114222.4.5.232",
          "oidSystem": "PHIN Questions",
          "standard": true,
          "nndMsg": true,
          "entryMethod": "USER",
          "questionType": "PHIN",
          "rdbTable": "D_PATIENT",
          "rdbColumn": "PATIENT_AGE_RPTD_UNIT",
          "otherValue": false,
          "groupSeq": null,
          "groupName": "GROUP_DEM",
          "subGroupName": "IPO",
          "blockName": null,
          "batchHeader": null,
          "batchColWidth": null,
          "mappings" : {
            "nnd" : {
              "identifier": "INV2002",
              "legacyIdentifier": "DEM218",
              "standard": false,
              "hl7Segment": "OBX-6-Units",
              "required": "O",
              "dataType": "CE",
              "orderGroup": "2"
            }
          }
        }
      ]
    },
    {
      "id": 1090981,
      "parent": 1090987,
      "order": 106,
      "name": "Exposure Location",
      "type": "Subsection",
      "required": false,
      "groupSeq": 1,
      "blockName": "EXPOSURE_LOCATION",
      "version": 1,
      "elements": [
        {
          "id": 1090983,
          "parent": 1090981,
          "order": 107,
          "label": "Country of Exposure",
          "name": "Country of Exposure",
          "description": "Indicates the country in which the disease was potentially acquired.",
          "tooltip": "Indicates the country in which the disease was potentially acquired.",
          "type": "Select",
          "dataType": "Coded",
          "identifier": "INV502",
          "relatedElement": null,
          "parentElement": null,
          "dataLocation": "NBS_CASE_ANSWER.ANSWER_TXT",
          "size": null,
          "min": null,
          "max": null,
          "version": 1,
          "valueSetCode": null,
          "oid": "2.16.840.1.113883.6.1",
          "oidSystem": "LOINC",
          "standard": true,
          "nndMsg": true,
          "entryMethod": "USER",
          "questionType": "PHIN",
          "rdbTable": "D_INVESTIGATION_REPEAT",
          "rdbColumn": "CNTRY_OF_EXP",
          "otherValue": false,
          "groupSeq": 1,
          "groupName": "GROUP_INV",
          "subGroupName": "EPI",
          "blockName": "EXPOSURE_LOCATION",
          "batchHeader": "Country of Exposure",
          "batchColWidth": 25,
          "mappings" : {
            "nnd" : {
              "identifier": "77984-3",
              "legacyIdentifier": null,
              "standard": false,
              "hl7Segment": "OBX-3.0",
              "required": "O",
              "dataType": "CWE",
              "orderGroup": "2"
            }
          }
        },
        {
          "id": 1091090,
          "parent": 1090981,
          "order": 107,
          "label": "State or Province of Exposure",
          "name": "State or Province of Exposure",
          "description": "Indicates the state in which the disease was potentially acquired.",
          "tooltip": "Indicates the state in which the disease was potentially acquired.",
          "type": "Select",
          "dataType": "Coded",
          "identifier": "INV503",
          "relatedElement": null,
          "parentElement": null,
          "dataLocation": "NBS_CASE_ANSWER.ANSWER_TXT",
          "size": null,
          "min": null,
          "max": null,
          "version": 1,
          "valueSetCode": null,
          "oid": "2.16.840.1.113883.6.1",
          "oidSystem": "LOINC",
          "standard": true,
          "nndMsg": true,
          "entryMethod": "USER",
          "questionType": "PHIN",
          "rdbTable": "D_INVESTIGATION_REPEAT",
          "rdbColumn": "ST_OR_PROV_OF_EXP",
          "otherValue": false,
          "groupSeq": 1,
          "groupName": "GROUP_INV",
          "subGroupName": "EPI",
          "blockName": "EXPOSURE_LOCATION",
          "batchHeader": "State or Province of Exposure",
          "batchColWidth": 25,
          "mappings" : {
            "nnd" : {
              "identifier": "77985-0",
              "legacyIdentifier": null,
              "standard": false,
              "hl7Segment": "OBX-3.0",
              "required": "O",
              "dataType": "CWE",
              "orderGroup": "2"
            }
          }
        }
      ]
    }
  ],
  "valueSets": [
    {
      "name": "AGE_UNIT",
      "assigningAuthority": "2.16.840.1.114222",
      "assigningAuthorityDesc": "Centers for Disease Control and Prevention",
      "description": "Units of measure for age",
      "valueSetOid": "2.16.840.1.114222.4.11.878",
      "valueSetName": "Age unit",
      "valueSetCode": "PHVS_AgeUnit_UCUM",
      "valueSetType": "PHIN",
      "modifiable": true,
      "version": "1",
      "effectiveFrom": "2010-04-08T17:32:00",
      "statusDate": "2008-10-22T00:00:00",
      "conceptsCount": 9,
      "concepts": [
        {
          "code": "UNK",
          "description": "unknown",
          "shortDesc": "Unknown",
          "codeSystem": "2.16.840.1.113883.6.8",
          "codeSystemDesc": "UCUM",
          "modifiable": true,
          "conceptType": "PHIN",
          "conceptCode": "UNK",
          "conceptName": "unknown",
          "preferredName": "Unknown",
          "version": "1",
          "effectiveFrom": "2008-09-24 00:00:00",
          "statusDate": "2010-05-13 16:20:00"
        },
        {
          "code": "a",
          "description": "year",
          "shortDesc": "Years",
          "codeSystem": "2.16.840.1.113883.6.8",
          "codeSystemDesc": "UCUM",
          "modifiable": true,
          "conceptType": "PHIN",
          "conceptCode": "a",
          "conceptName": "year",
          "preferredName": "Years",
          "version": "1",
          "effectiveFrom": "2008-09-24 00:00:00",
          "statusDate": "2010-05-13 16:20:0"
        }
      ]
    }
  ],
  "rules": [
    {
      "id": 6377,
      "code": "Enable",
      "expression": "INV128 ( Y ) = ^ E ( INV132 , INV133 , INV184 , INV134 ) ",
      "errorMsg": "Was the patient hospitalized for this illness? = must be ( Yes ) Admission Date, Discharge Date, Hospital, Total duration of stay in the hospital (in days)",
      "source": "INV128",
      "target": "INV132,INV133,INV184,INV134",
      "description": "IF 'Was the patient hospitalized for this illness? (INV128)' = 'Yes', THEN ENABLE 'Admission Date (INV132), Discharge Date (INV133), Hospital (INV184), Total duration of stay in the hospital (in days)(INV134)'",
      "userRuleId": "Rule1",
      "logic": "=",
      "sourceValues": "Yes",
      "targetType": "QUESTION",
      "functionName": "ruleEnDisINV1287131()",
      "function": "function ruleEnDisINV1287131()\n{\n var foo = [];\n$j('#INV128 :selected').each(function(i, selected){\n foo[i] = $j(selected).val();\n });\n\n if(($j.inArray('Y',foo) > -1) || ($j.inArray('Yes'.replace(/^\\s+|\\s+$/g,''),foo) > -1)){\npgEnableElement('INV132');\npgEnableElement('INV133');\npgEnableParticipationElement('INV184');\npgEnableElement('INV134');\n } else { \npgDisableElement('INV132');\npgDisableElement('INV133');\npgDisableParticipationElement('INV184');\npgDisableElement('INV134');\n }   \n}"
    },
    {
      "id": 6383,
      "code": "Date Compare",
      "expression": "INV132 <=  ^ DT ( INV133 ) ",
      "errorMsg": "Admission Date  must be <=  Discharge Date",
      "source": "INV132",
      "target": "INV133",
      "description": "'Admission Date (INV132)' must be <= 'Discharge Date (INV133)'.",
      "userRuleId": "Rule1010",
      "logic": "<=",
      "sourceValues": null,
      "targetType": null,
      "functionName": "ruleDCompINV1327137()",
      "function": "function ruleDCompINV1327137() {\n    var i = 0;\n    var errorElts = new Array(); \n    var errorMsgs = new Array(); \n\n if ((getElementByIdOrByName(\"INV132\").value)==''){ \n return {elements : errorElts, labels : errorMsgs}; }\n var sourceStr =getElementByIdOrByName(\"INV132\").value;\n var srcDate = sourceStr.substring(6,10) + sourceStr.substring(0,2) + sourceStr.substring(3,5);\n var targetElt;\n var targetStr = ''; \n var targetDate = '';\n targetStr =getElementByIdOrByName(\"INV133\") == null ? \"\" :getElementByIdOrByName(\"INV133\").value;\n if (targetStr!=\"\") {\n    targetDate = targetStr.substring(6,10) + targetStr.substring(0,2) + targetStr.substring(3,5);\n if (!(srcDate  <=  targetDate)) {\n var srcDateEle=getElementByIdOrByName(\"INV132\");\n var targetDateEle=getElementByIdOrByName(\"INV133\");\n var srca2str=buildErrorAnchorLink(srcDateEle,\"Admission Date\");\n var targeta2str=buildErrorAnchorLink(targetDateEle,\"Discharge Date\");\n    errorMsgs[i]=srca2str + \" must be  <=  \" + targeta2str; \n    colorElementLabelRed(srcDateEle); \n    colorElementLabelRed(targetDateEle); \nerrorElts[i++]=getElementByIdOrByName(\"INV133\"); \n}\n  }\n return {elements : errorElts, labels : errorMsgs}\n}"
    }
  ]
}


